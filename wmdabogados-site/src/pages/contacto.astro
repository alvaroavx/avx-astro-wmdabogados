---
import CardShell from "../layouts/CardShell.astro";
import { BROCHURE_URL } from "../utils/cards";
---

<CardShell title="Contacto | WMD Consultores" description="Contáctanos para recibir asesoría jurídica.">
  <section slot="desktop" class="grid h-full grid-rows-[auto,1fr] gap-3 p-3 md:gap-4 md:p-8">
    <header class="space-y-2">
      <h1 class="text-3xl text-petroleo md:text-4xl">Contacto</h1>
    </header>

    <div class="grid min-h-0 gap-3 md:gap-4 md:grid-cols-[0.9fr,1.1fr]">
      <aside class="flex min-h-0 flex-col gap-2 rounded-xl border border-petroleo/15 bg-gray-50 p-3 md:gap-3 md:p-5">
        <p class="rounded-lg bg-white p-3 text-sm leading-relaxed text-gray-700 md:text-base">
          Nos estamos trasladando a otra oficina, pronto informaremos nuestra nueva dirección.
        </p>

        <div class="rounded-lg bg-white p-3 text-sm md:text-base">
          <p><span class="font-semibold text-petroleo">Teléfono:</span> (56) 2 2415 9171</p>
          <a href={BROCHURE_URL} download class="mt-2 inline-block font-semibold underline underline-offset-4">Descargar brochure</a>
        </div>
      </aside>

      <form id="contact-form" class="grid min-h-0 grid-rows-[auto,auto,1fr,auto,auto] gap-2 rounded-xl border border-petroleo/15 bg-gray-50 p-3 md:gap-3 md:p-5" novalidate>
        <div>
          <label for="nombre" class="mb-1 block text-sm font-medium text-gray-700">Nombre</label>
          <input id="nombre" name="nombre" type="text" autocomplete="name" required />
        </div>

        <div>
          <label for="correo" class="mb-1 block text-sm font-medium text-gray-700">Correo</label>
          <input id="correo" name="correo" type="email" autocomplete="email" required />
        </div>

        <div class="min-h-0">
          <label for="mensaje" class="mb-1 block text-sm font-medium text-gray-700">Mensaje</label>
          <textarea id="mensaje" name="mensaje" rows="4" class="h-[calc(100%-1.75rem)] min-h-[72px] resize-none md:min-h-[96px]" required></textarea>
        </div>

        <button type="submit" class="btn btn-primary w-full md:w-auto">Enviar</button>

        <p id="form-status" class="text-sm font-medium" aria-live="polite"></p>
      </form>
    </div>
  </section>

  <section slot="mobile" class="d-grid gap-3">
    <div class="card border-0 shadow-sm">
      <div class="card-body">
        <h1 class="h4 text-petroleo mb-2">Contacto</h1>
        <p class="mb-3">Nos estamos trasladando a otra oficina, pronto informaremos nuestra nueva dirección.</p>
        <p class="mb-1"><strong>Teléfono:</strong> (56) 2 2415 9171</p>
        <a href={BROCHURE_URL} download class="btn btn-outline-primary btn-sm mt-2">Descargar brochure</a>
      </div>
    </div>

    <form id="contact-form-mobile" class="card border-0 shadow-sm">
      <div class="card-body d-grid gap-3">
        <div>
          <label for="nombre-mobile" class="form-label">Nombre</label>
          <input id="nombre-mobile" name="nombre" type="text" class="form-control" required />
        </div>
        <div>
          <label for="correo-mobile" class="form-label">Correo</label>
          <input id="correo-mobile" name="correo" type="email" class="form-control" required />
        </div>
        <div>
          <label for="mensaje-mobile" class="form-label">Mensaje</label>
          <textarea id="mensaje-mobile" name="mensaje" rows="4" class="form-control" required></textarea>
        </div>
        <button type="submit" class="btn btn-primary">Enviar</button>
        <p id="form-status-mobile" class="small mb-0" aria-live="polite"></p>
      </div>
    </form>
  </section>

  <script is:inline>
    const form = document.querySelector("#contact-form");
    const status = document.querySelector("#form-status");

    if (form && status) {
      form.addEventListener("submit", async (event) => {
        event.preventDefault();
        status.className = "text-sm font-medium text-gray-700";
        status.textContent = "Enviando...";

        const data = new FormData(form);
        const nombre = (data.get("nombre") ?? "").toString().trim();
        const correo = (data.get("correo") ?? "").toString().trim();
        const mensaje = (data.get("mensaje") ?? "").toString().trim();

        if (!nombre || !correo || !mensaje) {
          status.className = "text-sm font-medium text-red-700";
          status.textContent = "Lo sentimos, ha habido un problema, por favor intente nuevamente.";
          return;
        }

        await new Promise((resolve) => setTimeout(resolve, 500));
        status.className = "text-sm font-medium text-green-700";
        status.textContent = "¡Muchas gracias! Su correo ha sido enviado.";
        form.reset();
      });
    }

    const formMobile = document.querySelector("#contact-form-mobile");
    const statusMobile = document.querySelector("#form-status-mobile");

    if (formMobile && statusMobile) {
      formMobile.addEventListener("submit", async (event) => {
        event.preventDefault();
        statusMobile.className = "small mb-0 text-muted";
        statusMobile.textContent = "Enviando...";

        const data = new FormData(formMobile);
        const nombre = (data.get("nombre") ?? "").toString().trim();
        const correo = (data.get("correo") ?? "").toString().trim();
        const mensaje = (data.get("mensaje") ?? "").toString().trim();

        if (!nombre || !correo || !mensaje) {
          statusMobile.className = "small mb-0 text-danger";
          statusMobile.textContent = "Lo sentimos, ha habido un problema, por favor intente nuevamente.";
          return;
        }

        await new Promise((resolve) => setTimeout(resolve, 500));
        statusMobile.className = "small mb-0 text-success";
        statusMobile.textContent = "¡Muchas gracias! Su correo ha sido enviado.";
        formMobile.reset();
      });
    }
  </script>
</CardShell>

